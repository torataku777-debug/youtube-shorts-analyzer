module.exports = [
"[externals]/next/dist/compiled/next-server/app-route-turbo.runtime.dev.js [external] (next/dist/compiled/next-server/app-route-turbo.runtime.dev.js, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/compiled/next-server/app-route-turbo.runtime.dev.js", () => require("next/dist/compiled/next-server/app-route-turbo.runtime.dev.js"));

module.exports = mod;
}),
"[externals]/next/dist/compiled/@opentelemetry/api [external] (next/dist/compiled/@opentelemetry/api, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/compiled/@opentelemetry/api", () => require("next/dist/compiled/@opentelemetry/api"));

module.exports = mod;
}),
"[externals]/next/dist/compiled/next-server/app-page-turbo.runtime.dev.js [external] (next/dist/compiled/next-server/app-page-turbo.runtime.dev.js, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/compiled/next-server/app-page-turbo.runtime.dev.js", () => require("next/dist/compiled/next-server/app-page-turbo.runtime.dev.js"));

module.exports = mod;
}),
"[externals]/next/dist/server/app-render/work-unit-async-storage.external.js [external] (next/dist/server/app-render/work-unit-async-storage.external.js, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/server/app-render/work-unit-async-storage.external.js", () => require("next/dist/server/app-render/work-unit-async-storage.external.js"));

module.exports = mod;
}),
"[externals]/next/dist/server/app-render/work-async-storage.external.js [external] (next/dist/server/app-render/work-async-storage.external.js, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/server/app-render/work-async-storage.external.js", () => require("next/dist/server/app-render/work-async-storage.external.js"));

module.exports = mod;
}),
"[externals]/next/dist/shared/lib/no-fallback-error.external.js [external] (next/dist/shared/lib/no-fallback-error.external.js, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/shared/lib/no-fallback-error.external.js", () => require("next/dist/shared/lib/no-fallback-error.external.js"));

module.exports = mod;
}),
"[externals]/next/dist/server/app-render/after-task-async-storage.external.js [external] (next/dist/server/app-render/after-task-async-storage.external.js, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/server/app-render/after-task-async-storage.external.js", () => require("next/dist/server/app-render/after-task-async-storage.external.js"));

module.exports = mod;
}),
"[project]/lib/supabase.ts [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "supabase",
    ()=>supabase
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$supabase$2f$supabase$2d$js$2f$dist$2f$index$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@supabase/supabase-js/dist/index.mjs [app-route] (ecmascript) <locals>");
;
const supabaseUrl = ("TURBOPACK compile-time value", "https://tklhjlaxneckylyiaemh.supabase.co");
const supabaseAnonKey = ("TURBOPACK compile-time value", "sb_publishable_nYafcd4siOL9e3VdQsg_Dw_50yeEPBQ");
const supabase = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$supabase$2f$supabase$2d$js$2f$dist$2f$index$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$locals$3e$__["createClient"])(supabaseUrl, supabaseAnonKey);
}),
"[externals]/child_process [external] (child_process, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("child_process", () => require("child_process"));

module.exports = mod;
}),
"[externals]/fs [external] (fs, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("fs", () => require("fs"));

module.exports = mod;
}),
"[externals]/https [external] (https, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("https", () => require("https"));

module.exports = mod;
}),
"[externals]/stream [external] (stream, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("stream", () => require("stream"));

module.exports = mod;
}),
"[externals]/os [external] (os, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("os", () => require("os"));

module.exports = mod;
}),
"[externals]/events [external] (events, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("events", () => require("events"));

module.exports = mod;
}),
"[externals]/process [external] (process, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("process", () => require("process"));

module.exports = mod;
}),
"[externals]/util [external] (util, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("util", () => require("util"));

module.exports = mod;
}),
"[externals]/path [external] (path, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("path", () => require("path"));

module.exports = mod;
}),
"[externals]/crypto [external] (crypto, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("crypto", () => require("crypto"));

module.exports = mod;
}),
"[externals]/querystring [external] (querystring, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("querystring", () => require("querystring"));

module.exports = mod;
}),
"[externals]/buffer [external] (buffer, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("buffer", () => require("buffer"));

module.exports = mod;
}),
"[externals]/http2 [external] (http2, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("http2", () => require("http2"));

module.exports = mod;
}),
"[externals]/zlib [external] (zlib, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("zlib", () => require("zlib"));

module.exports = mod;
}),
"[externals]/url [external] (url, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("url", () => require("url"));

module.exports = mod;
}),
"[project]/lib/youtube-server.ts [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "fetchChannelStats",
    ()=>fetchChannelStats,
    "fetchTrendingShorts",
    ()=>fetchTrendingShorts
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$googleapis$2f$build$2f$src$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/googleapis/build/src/index.js [app-route] (ecmascript)");
;
const youtube = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$googleapis$2f$build$2f$src$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["google"].youtube('v3');
const YOUTUBE_API_KEY = process.env.YOUTUBE_API_KEY;
if (!YOUTUBE_API_KEY) {
    throw new Error('YOUTUBE_API_KEY is not defined');
}
function parseDuration(duration) {
    const match = duration.match(/PT(\d+H)?(\d+M)?(\d+S)?/);
    if (!match) return 0;
    const hours = parseInt(match[1] || '0') || 0;
    const minutes = parseInt(match[2] || '0') || 0;
    const seconds = parseInt(match[3] || '0') || 0;
    return hours * 3600 + minutes * 60 + seconds;
}
function containsJapanese(text) {
    return /[\u3000-\u303f\u3040-\u309f\u30a0-\u30ff\uff00-\uff9f\u4e00-\u9faf\u3400-\u4dbf]/.test(text);
}
// Kids Content Blacklist
const KIDS_KEYWORDS = [
    'CoComelon',
    'BabyBus',
    'Bebefinn',
    'Little Angel',
    'Super Simple Songs',
    'Pinkfong',
    'ChuChu TV',
    'LooLoo Kids',
    'Blippi',
    'Vlad and Niki',
    'Diana and Roma',
    'Like Nastya',
    'Maria Clara & JP',
    'Kids',
    'Nursery Rhymes',
    'あかちゃん',
    'キッズ',
    '子供向け',
    '童謡'
];
function isKidsContent(item) {
    // 1. YouTube API Flag
    if (item.status?.madeForKids) return true;
    // 2. Category 1 (Film & Animation) - very high correlation with kids content on Shorts
    // But strictly, we might not want to ban ALL animation. 
    // User asked to exclude Category 1 previously, so we keep that logic as "Kids-like" for now?
    // Actually, user said "Exclude Category 1 OR global kids channels".
    if (item.snippet?.categoryId === '1') return true;
    // 3. Keyword/Channel Check
    const title = (item.snippet?.title || '').toLowerCase();
    const channel = (item.snippet?.channelTitle || '').toLowerCase();
    return KIDS_KEYWORDS.some((k)=>title.includes(k.toLowerCase()) || channel.includes(k.toLowerCase()));
}
async function fetchTrendingShorts(options, targetCount = 20) {
    try {
        let shorts = [];
        // Strategy 1: Real Trends (mostPopular)
        console.log(`[${options.regionCode}] Strategy 1: Scanning Most Popular...`);
        for(let i = 0; i < 3; i++){
            const response = await youtube.videos.list({
                key: YOUTUBE_API_KEY,
                part: [
                    'snippet',
                    'statistics',
                    'contentDetails',
                    'status'
                ],
                chart: 'mostPopular',
                regionCode: options.regionCode,
                maxResults: 50
            });
            const items = response.data.items || [];
            const pageShorts = items.filter((item)=>{
                const d = parseDuration(item.contentDetails?.duration || '');
                return d > 0 && d <= 61;
            });
            shorts = [
                ...shorts,
                ...pageShorts
            ];
            if (!response.data.nextPageToken) break;
        }
        console.log(`[${options.regionCode}] Trends strategy found: ${shorts.length}`);
        // Strategy 2: Search Backfill
        if (shorts.length < targetCount) {
            console.log(`[${options.regionCode}] Strategy 2: Searching keywords...`);
            const queries = [
                `${options.keywords.join('|')} #Shorts`,
                '#Shorts'
            ];
            for (const query of queries){
                if (shorts.length >= targetCount) break;
                const response = await youtube.search.list({
                    key: YOUTUBE_API_KEY,
                    part: [
                        'snippet'
                    ],
                    q: query,
                    type: [
                        'video'
                    ],
                    videoDuration: 'short',
                    regionCode: options.regionCode,
                    relevanceLanguage: options.relevanceLanguage,
                    order: 'viewCount',
                    maxResults: 50
                });
                const searchItems = response.data.items || [];
                const videoIds = searchItems.map((i)=>i.id?.videoId).filter(Boolean);
                if (videoIds.length > 0) {
                    const details = await youtube.videos.list({
                        key: YOUTUBE_API_KEY,
                        part: [
                            'snippet',
                            'statistics',
                            'contentDetails',
                            'status'
                        ],
                        id: videoIds
                    });
                    const items = details.data.items || [];
                    const filtered = items.filter((item)=>{
                        const d = parseDuration(item.contentDetails?.duration || '');
                        if (d <= 0 || d > 61) return false;
                        // Language Filter
                        if (options.regionCode === 'JP') {
                            const hasJP = containsJapanese(item.snippet?.title || '') || containsJapanese(item.snippet?.description || '');
                            if (!hasJP) return false;
                        }
                        return true;
                    });
                    shorts = [
                        ...shorts,
                        ...filtered
                    ];
                }
            }
        }
        // Dedup & Determine is_kids
        const uniqueMap = new Map();
        shorts.forEach((s)=>{
            if (!uniqueMap.has(s.id)) {
                // Attach our computed is_kids flag to the object for easy access later
                s.is_kids_computed = isKidsContent(s);
                uniqueMap.set(s.id, s);
            }
        });
        const finalShorts = Array.from(uniqueMap.values());
        console.log(`[${options.regionCode}] Final count: ${finalShorts.length}`);
        return finalShorts;
    } catch (error) {
        console.error('Error fetching trending shorts:', error);
        return [];
    }
}
async function fetchChannelStats(channelIds) {
    try {
        const response = await youtube.channels.list({
            key: YOUTUBE_API_KEY,
            part: [
                'snippet',
                'statistics'
            ],
            id: channelIds
        });
        return response.data.items || [];
    } catch (error) {
        console.error('Error fetching channel stats:', error);
        return [];
    }
}
}),
"[project]/lib/keyword-extractor.ts [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "extractTrendingKeywords",
    ()=>extractTrendingKeywords
]);
const STOP_WORDS = new Set([
    // English Stop Words
    'the',
    'be',
    'to',
    'of',
    'and',
    'a',
    'in',
    'that',
    'have',
    'i',
    'it',
    'for',
    'not',
    'on',
    'with',
    'he',
    'as',
    'you',
    'do',
    'at',
    'this',
    'but',
    'his',
    'by',
    'from',
    'they',
    'we',
    'say',
    'her',
    'she',
    'or',
    'an',
    'will',
    'my',
    'one',
    'all',
    'would',
    'there',
    'their',
    'what',
    'so',
    'up',
    'out',
    'if',
    'about',
    'who',
    'get',
    'which',
    'go',
    'me',
    'when',
    'make',
    'can',
    'like',
    'time',
    'no',
    'just',
    'him',
    'know',
    'take',
    'people',
    'into',
    'year',
    'your',
    'good',
    'some',
    'could',
    'them',
    'see',
    'other',
    'than',
    'then',
    'now',
    'look',
    'only',
    'come',
    'its',
    'over',
    'think',
    'also',
    'back',
    'after',
    'use',
    'two',
    'how',
    'our',
    'work',
    'first',
    'well',
    'way',
    'even',
    'new',
    'want',
    'because',
    'any',
    'these',
    'give',
    'day',
    'most',
    'us',
    'youtube',
    'video',
    'shorts',
    'short',
    'channel',
    // Japanese Stop Words (common particles and generic terms)
    'の',
    'に',
    'は',
    'を',
    'た',
    'が',
    'で',
    'て',
    'と',
    'し',
    'れ',
    'さ',
    'ある',
    'いる',
    'も',
    'する',
    'から',
    'な',
    'こと',
    'として',
    'い',
    'や',
    'れる',
    'など',
    'なっ',
    'ない',
    'この',
    'ため',
    'その',
    'あっ',
    'よう',
    'また',
    'もの',
    'という',
    'あり',
    'まで',
    'られ',
    'なる',
    'へ',
    'か',
    'だ',
    'これ',
    'によって',
    'により',
    'おり',
    'より',
    'による',
    'ず',
    'なり',
    'られる',
    'において',
    'ば',
    'なかっ',
    'なく',
    'しかし',
    'について',
    'せ',
    'だっ',
    'その後',
    'できる',
    'そこ',
    '動画',
    'ショート',
    '登録',
    'チャンネル'
]);
function extractTrendingKeywords(videos) {
    const wordCounts = new Map();
    videos.forEach((video)=>{
        // Combine title and description
        const text = (video.title + " " + (video.description || "")).toLowerCase();
        // Extract hashtags explicitly
        const hashtags = text.match(/#[^\s#]+/g) || [];
        hashtags.forEach((tag)=>{
            const cleanTag = tag.replace('#', '');
            if (cleanTag.length > 1) {
                wordCounts.set(cleanTag, (wordCounts.get(cleanTag) || 0) + 1);
            }
        });
        // Tokenize text for words (simple space separation for EN, could use tokenizer for JP but simple regex works for major keywords)
        // Removing special chars
        const cleanText = text.replace(/#[^\s#]+/g, '') // remove hashtags from text stream to avoid double counting
        .replace(/[!?,.。"';:()\[\]]/g, ' ');
        const words = cleanText.split(/\s+/);
        words.forEach((word)=>{
            if (word.length < 2) return;
            if (STOP_WORDS.has(word)) return;
            if (/^\d+$/.test(word)) return; // skip numbers
            wordCounts.set(word, (wordCounts.get(word) || 0) + 1);
        });
    });
    // Convert to array and sort
    const sortedKeywords = Array.from(wordCounts.entries()).map(([keyword, count])=>({
            keyword,
            count
        })).sort((a, b)=>b.count - a.count);
    // Return top 20
    return sortedKeywords.slice(0, 20);
}
}),
"[project]/app/api/ingest/route.ts [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "GET",
    ()=>GET,
    "dynamic",
    ()=>dynamic
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/server.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$lib$2f$supabase$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/lib/supabase.ts [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$lib$2f$youtube$2d$server$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/lib/youtube-server.ts [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$lib$2f$keyword$2d$extractor$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/lib/keyword-extractor.ts [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$googleapis$2f$build$2f$src$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/googleapis/build/src/index.js [app-route] (ecmascript)");
;
;
;
;
;
const dynamic = 'force-dynamic';
const youtube = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$googleapis$2f$build$2f$src$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["google"].youtube('v3');
const YOUTUBE_API_KEY = process.env.YOUTUBE_API_KEY;
// Helper to save channels and videos to DB (reusable for both main ingest and deep ingest)
async function saveToDatabase(videoStats, regionCode) {
    if (videoStats.length === 0) return 0;
    // Upsert Channels
    const channelIds = [
        ...new Set(videoStats.map((v)=>v.snippet.channelId))
    ];
    const channelStats = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$lib$2f$youtube$2d$server$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["fetchChannelStats"])(channelIds);
    const channelsData = channelStats.map((c)=>({
            youtube_id: c.id,
            title: c.snippet.title,
            thumbnail_url: c.snippet.thumbnails.default.url,
            custom_url: c.snippet.customUrl,
            video_count: parseInt(c.statistics.videoCount || '0'),
            view_count: parseInt(c.statistics.viewCount || '0'),
            published_at: c.snippet.publishedAt,
            country: c.snippet.country || regionCode
        }));
    await __TURBOPACK__imported__module__$5b$project$5d2f$lib$2f$supabase$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["supabase"].from('channels').upsert(channelsData, {
        onConflict: 'youtube_id'
    });
    // Upsert Videos
    const { data: storedChannels } = await __TURBOPACK__imported__module__$5b$project$5d2f$lib$2f$supabase$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["supabase"].from('channels').select('id, youtube_id').in('youtube_id', channelIds);
    const channelMap = new Map(storedChannels?.map((c)=>[
            c.youtube_id,
            c.id
        ]));
    const videosData = videoStats.map((v)=>({
            youtube_id: v.id,
            channel_id: channelMap.get(v.snippet.channelId),
            title: v.snippet.title,
            description: v.snippet.description,
            published_at: v.snippet.publishedAt,
            thumbnail_url: v.snippet.thumbnails.high?.url || v.snippet.thumbnails.default.url,
            duration: v.contentDetails.duration,
            region: regionCode,
            is_kids: v.is_kids_computed
        })).filter((v)=>v.channel_id);
    const { data: storedVideos, error: videoError } = await __TURBOPACK__imported__module__$5b$project$5d2f$lib$2f$supabase$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["supabase"].from('videos').upsert(videosData, {
        onConflict: 'youtube_id'
    }).select();
    if (videoError) console.error(videoError);
    // Metrics
    if (storedVideos) {
        const videoMap = new Map(storedVideos.map((v)=>[
                v.youtube_id,
                v.id
            ]));
        const metricsData = videoStats.map((v)=>({
                video_id: videoMap.get(v.id),
                view_count: parseInt(v.statistics.viewCount || '0'),
                like_count: parseInt(v.statistics.likeCount || '0'),
                comment_count: parseInt(v.statistics.commentCount || '0'),
                recorded_at: new Date().toISOString()
            })).filter((m)=>m.video_id);
        await __TURBOPACK__imported__module__$5b$project$5d2f$lib$2f$supabase$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["supabase"].from('daily_metrics').insert(metricsData);
    }
    return videosData.length;
}
async function GET() {
    try {
        console.log('Starting Multi-Region Deep Ingest...');
        const regions = [
            {
                code: 'JP',
                lang: 'ja',
                keywords: [
                    '切り抜き',
                    'あるある',
                    '歌ってみた',
                    '解説',
                    '猫',
                    '料理',
                    'ダンス'
                ]
            },
            {
                code: 'US',
                lang: 'en',
                keywords: [
                    'funny',
                    'challenge',
                    'tutorial',
                    'gameplay',
                    'meme',
                    'lifehack'
                ]
            }
        ];
        let totalVideos = 0;
        for (const region of regions){
            console.log(`Processing Region: ${region.code}`);
            // 1. Initial Ingest (Trends + Manual Keywords)
            const initialVideos = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$lib$2f$youtube$2d$server$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["fetchTrendingShorts"])({
                regionCode: region.code,
                relevanceLanguage: region.lang,
                keywords: region.keywords
            }, 50);
            const savedCount = await saveToDatabase(initialVideos, region.code);
            totalVideos += savedCount;
            // 2. Keyword Extraction
            const videosForExtraction = initialVideos.map((v)=>({
                    title: v.snippet.title,
                    description: v.snippet.description
                }));
            const extractedKeywords = (0, __TURBOPACK__imported__module__$5b$project$5d2f$lib$2f$keyword$2d$extractor$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["extractTrendingKeywords"])(videosForExtraction);
            // Save keywords to DB
            const keywordsToUpsert = extractedKeywords.slice(0, 20).map((k)=>({
                    keyword: k.keyword,
                    region: region.code,
                    frequency: k.count
                }));
            if (keywordsToUpsert.length > 0) {
                await __TURBOPACK__imported__module__$5b$project$5d2f$lib$2f$supabase$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["supabase"].from('trending_keywords').upsert(keywordsToUpsert, {
                    onConflict: 'keyword,region'
                });
            }
            // 3. Deep Search (Top 5 Keywords)
            console.log(`[${region.code}] Starting Deep Search on top keywords...`);
            const topKeywords = extractedKeywords.slice(0, 5); // Take top 5
            for (const k of topKeywords){
                console.log(`[${region.code}] Deep Search: ${k.keyword}`);
                const deepVideos = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$lib$2f$youtube$2d$server$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["fetchTrendingShorts"])({
                    regionCode: region.code,
                    relevanceLanguage: region.lang,
                    keywords: [
                        k.keyword
                    ] // Recursively search for this new keyword
                }, 10); // Fetch a small batch per keyword
                const deepSaved = await saveToDatabase(deepVideos, region.code);
                totalVideos += deepSaved;
            }
        }
        return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
            success: true,
            totalProcessed: totalVideos
        });
    } catch (error) {
        console.error('API Error:', error);
        return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
            error: 'Internal Server Error'
        }, {
            status: 500
        });
    }
}
}),
];

//# sourceMappingURL=%5Broot-of-the-server%5D__91d41077._.js.map